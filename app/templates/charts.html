{% extends "base.html" %}
{% block title %}Josien.net dev{% endblock %}
{% block content -%}
<div class="container-fluid">


<canvas id="trxs" width="200" height="50"></canvas>

<script>

let url='./_trxs';

function onRefresh(chart){
  fetch(url)
  .then((res) => res.json())
  .then((data) => {
    chart.config.data.datasets.forEach(function(dataset) {
        dataset.data.push({
                t: Date.now(),
                // t: data.t,
                y: data.y
            });
        })
  })
  .catch((err) => console.log(err))
}

var config = {
  type: 'line',
  data: {
    datasets: [ {
            label: 'trxs',
            backgroundColor: '#533a75',
            borderColor: '#533a75',
            fill: false,
            data: []
        }
    ],
  },
    options: {
        events: [],
        title: {
            display: true,
            text: 'Amount of transactions per 0.5 seconds'
        },
        scales: {
            xAxes: [{
                type: 'realtime',
                realtime: {
                    duration: 200000,
                    refresh: 500,
                    delay: 2000,
                    onRefresh: onRefresh
                }
            }],
        },
        // tooltips: { mode: 'nearest', intersect: false },
        tooltips: {enabled: false},
        states: { hover: { filter: { type: 'none', } }, },
        hover: {mode: null}
        // hover: { mode: 'nearest', intersect: false }
    }
};

window.onload = function() {
    var ctx = document.getElementById('trxs').getContext('2d');
    window.trxs = new Chart(ctx, config);
};
</script>

<!--
<button class="btn btn-outline-dark btn-sm" id="7" onClick="graph(this.id)">7 days</button>
<button class="btn btn-outline-dark btn-sm" id="14" onClick="graph(this.id)">14 days</button>
<button class="btn btn-outline-dark btn-sm" id="30" onClick="graph(this.id)">30 days</button>
<button class="btn btn-outline-dark btn-sm" id="60" onClick="graph(this.id)">60 days</button>
<button class="btn btn-outline-dark btn-sm" id="182" onClick="graph(this.id)">182 days</button>
<button class="btn btn-outline-dark btn-sm" id="365" onClick="graph(this.id)">365 days</button>
<div style="padding-top:10px;" id="cpu_benchmark" style="height: 400px; min-width: 310px"></div>
-->

</div>
{%- endblock content %}
{% block scripts %}
    {{ super() }}
<script type=text/javascript>
  var $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
</script>
{%- endblock scripts %}
